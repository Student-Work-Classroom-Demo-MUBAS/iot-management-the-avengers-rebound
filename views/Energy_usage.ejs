<%- include('partials/header') %>
<%- include('partials/sidebar') %>

<div class="main-content">
  <div class="header">
    <div class="page-title">
      <h2>Energy Usage</h2>
      <p>Track consumption, peaks, and device breakdowns</p>
    </div>
    <div class="actions">
      <button class="btn"><i class="fas fa-sync"></i> Refresh</button>
      <button class="btn"><i class="fas fa-download"></i> Export</button>
    </div>
  </div>

  <div class="dashboard-cards">
    <div class="card energy">
      <div class="card-header">
        <div class="card-title">Total Today</div>
        <div class="card-icon energy-icon"><i class="fas fa-plug"></i></div>
      </div>
      <div class="card-value"><%= data.energy.totalToday %></div>
      <div class="card-footer">
        <span>Estimated cost: <%= data.energy.estimatedCost %></span>
        <span class="trend <%= data.energy.trend %>">
          <i class="fas fa-arrow-<%= data.energy.trend %>"></i> <%= data.energy.trendValue %>
        </span>
      </div>
    </div>

    <div class="card current">
      <div class="card-header">
        <div class="card-title">Current Usage</div>
        <div class="card-icon current-icon"><i class="fas fa-bolt"></i></div>
      </div>
      <div class="card-value"><%= data.energy.currentUsage %></div>
      <div class="card-footer"><span>Updated: <%= data.energy.lastUpdated %></span></div>
    </div>

    <div class="card peak">
      <div class="card-header">
        <div class="card-title">Peak Hour</div>
        <div class="card-icon"><i class="fas fa-chart-line"></i></div>
      </div>
      <div class="card-value"><%= data.energy.peakHour.value %></div>
      <div class="card-footer"><span>At: <%= data.energy.peakHour.time %></span></div>
    </div>
  </div>

  <div class="charts">
    <div class="chart-container">
      <div class="chart-header">
        <div class="chart-title">Consumption - Last 24 Hours</div>
        <div class="chart-actions">
          <button class="chart-btn active">Day</button>
          <button class="chart-btn">Week</button>
          <button class="chart-btn">Month</button>
        </div>
      </div>
      <canvas id="energyUsageChart" height="320"></canvas>
    </div>

    <div class="chart-container">
      <div class="chart-header">
        <div class="chart-title">By Device Category</div>
      </div>
      <canvas id="energyByDeviceChart" height="320"></canvas>
    </div>
  </div>

  <div class="devices-container">
    <div class="devices-header">
      <div class="devices-title">Device Consumption Breakdown</div>
      <div class="filters">
        <select>
          <option>All Rooms</option>
          <% data.energy.rooms.forEach(function(room){ %>
            <option><%= room %></option>
          <% }) %>
        </select>
      </div>
    </div>
    <table class="device-table">
      <thead>
        <tr>
          <th>Device</th>
          <th>Category</th>
          <th>Room</th>
          <th>Power</th>
          <th>Energy (Today)</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <% data.energy.devices.forEach(function(d){ %>
          <tr>
            <td class="device-info">
              <div class="device-icon"><i class="<%= d.icon %>"></i></div>
              <div>
                <div class="device-name"><%= d.name %></div>
                <div class="device-location"><%= d.model %></div>
              </div>
            </td>
            <td><%= d.category %></td>
            <td><%= d.room %></td>
            <td><%= d.power %></td>
            <td><%= d.energyToday %></td>
            <td><span class="status status-<%= d.status.toLowerCase() %>"><%= d.status %></span></td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</div>